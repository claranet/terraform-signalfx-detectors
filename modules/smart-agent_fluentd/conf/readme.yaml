documentations:
  - name: Smart Agent monitor
    url: 'https://docs.signalfx.com/en/latest/integrations/agent/monitors/prometheus-exporter.html'

source_doc: |
  ### Agent

  Here is the official [main
  documentation](https://docs.signalfx.com/en/latest/integrations/integrations-reference/integrations.kubernetes.html) for
  kubernetes including the `signalfx-agent` installation which must be installed as
  [daemonset](https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/) on your cluster.

  ### Monitors

  The detectors in this module are based on metrics reported by the following monitors:

  * [prometheus-exporter](https://docs.signalfx.com/en/latest/integrations/agent/monitors/prometheus-exporter.html)

  Detectors in this module will at least require these metric:

  * `fluentd_output_status_buffer_stage_length`

  This metric is enabled by default, but it is the only one used on the detectors.

  ### Fluentd Prometheus

  For using this detector, the instance has to have an entrypoint prometheus exposing the information of fluentd.
  You have to install fluent-plugin-prometheus on the server and adding the monitoring configuration to td-agent to use it.
  More info on the doc [Fluentd](https://docs.fluentd.org/monitoring-fluentd/monitoring-prometheus)

notes: |
  Here an example of the monitor configuration
  ```yaml
  - type: prometheus-exporter
  host: 127.0.0.1
  port: 24231
  - metricNames:
      - '*'
      - '!fluentd_output_status_buffer_stage_length'
  ```

  You can find all the metrics on the repository [fluent-plugin-prometheus](https://github.com/fluent/fluent-plugin-prometheus/blob/master/README.md)
