module: AWS RDS Common
id: "cpu_usage"
name: "Instance CPU"

filtering: "filter('namespace', 'AWS/RDS')"
value_unit: "%"
condition: "var.cpu_usage_detector_enabled"

signals:
  signal:
    metric: CPUUtilization
    filter: "filter('stat', 'mean') and filter('DBInstanceIdentifier', '*')"

rules:
  critical:
    threshold: 90
    comparator: ">"
    lasting_duration: "15m"
  major:
    threshold: 80
    comparator: ">"
    lasting_duration: "15m"
    dependency: critical
