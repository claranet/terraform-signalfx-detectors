module: AWS RDS Common
name: "Replica lag"

filtering: "filter('namespace', 'AWS/RDS')"
condition: "var.replica_lag_detector_enabled"

signals:
  signal:
    metric: ReplicaLag
    filter: "filter('stat', 'mean') and filter('DBInstanceIdentifier', '*')"

rules:
  critical:
    threshold: 300
    comparator: ">"
    duration: "5m"
  major:
    threshold: 200
    comparator: ">"
    duration: "5m"
    dependency: critical
