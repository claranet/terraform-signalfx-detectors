module: "GCP Cloud SQL"
name: "Memory left"
id: "memory_utilization"

transformation: ".min(over='15m')"
aggregation: true
filtering: "filter('project_id', '${var.gcp_project_id}') and filter('component', 'Free')"

signals:
  signal:
    metric: "database/memory/components"

rules:
  critical:
    threshold: 10
    comparator: "<"
    
  major:
    threshold: 20
    comparator: "<"
    dependency: "critical"
