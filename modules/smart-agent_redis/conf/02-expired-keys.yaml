module: redis
name: expired keys change rate

filtering: "filter('plugin', 'redis_info')"

signals:
  signal:
    metric: counter.evicted_keys
    rollup: delta
    function: ".rateofchange()"

rules:
  critical:
    threshold: 100
    comparator: '>'
    lasting_duration: 15m
    lasting_at_least: 0.5
  major:
    threshold: 50
    comparator: '>'
    lasting_duration: 15m
    lasting_at_least: 0.5
    dependency: critical
