module: redis
name: high memory fragmentation ratio

filtering: "filter('plugin', 'redis_info')"

signals:
  A:
    metric: bytes.used_memory_rss
    rollup: average
  B:
    metric: bytes.used_memory
    rollup: average
  signal:
    formula: (A/B)

rules:
  critical:
    threshold: 5
    comparator: '>'
    lasting_duration: 15m
    lasting_at_least: 0.5
  major:
    threshold: 2
    comparator: '>'
    dependency: critical
    lasting_duration: 15m
    lasting_at_least: 0.5
